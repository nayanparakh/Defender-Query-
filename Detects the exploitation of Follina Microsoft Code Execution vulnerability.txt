DeviceEvents
| where InitiatingProcessParentFileName  has_any ('winword.exe','excel.exe','outlook.exe')
| where FileName  contains "msdt.exe" or ProcessCommandLine contains "msdt.exe"
| project FileName,ProcessCommandLine,InitiatingProcessParentFileName,AccountName,DeviceName



====================================================
//Detect of Sdiagnhost calling API or Source // Could generate valid processes
DeviceEvents
| where ActionType == @"CreateRemoteThreadApiCall"
| where ProcessCommandLine contains "sdiagnhost.exe"

